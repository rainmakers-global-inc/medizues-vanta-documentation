<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>MediZues Vanta Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./mdbook-admonish.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Documents: Engineering</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="intrusion-detection-system-installation.html"><strong aria-hidden="true">1.1.</strong> Intrusion Detection System Installation</a></li><li class="chapter-item expanded "><a href="network-diagram.html"><strong aria-hidden="true">1.2.</strong> Network Diagram</a></li><li class="chapter-item expanded "><a href="network-segregation.html"><strong aria-hidden="true">1.3.</strong> Network Segregation</a></li><li class="chapter-item expanded "><a href="application-access-request-denied-log.html"><strong aria-hidden="true">1.4.</strong> Application Access Request Denied Log</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Documents: Policy</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="incident-report-or-root-cause-analysis.html"><strong aria-hidden="true">2.1.</strong> Incident report or root cause analysis</a></li><li class="chapter-item expanded "><a href="test-of-incident-response-plan.html"><strong aria-hidden="true">2.2.</strong> Test of incident response plan</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">To-Do</li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Documents: Human resources</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="proof-of-completed-access-review.html"><strong aria-hidden="true">3.1.</strong> Proof of completed access review</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Documents: Engineering</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="application-session-timeout.html"><strong aria-hidden="true">4.1.</strong> Application Session Timeout</a></li><li class="chapter-item expanded "><a href="data-restore-test.html"><strong aria-hidden="true">4.2.</strong> Data Restore Test</a></li><li class="chapter-item expanded "><a href="enabled-automated-log-alerting.html"><strong aria-hidden="true">4.3.</strong> Enabled Automated Log Alerting</a></li><li class="chapter-item expanded "><a href="penetration-test-remediation.html"><strong aria-hidden="true">4.4.</strong> Penetration Test Remediation</a></li><li class="chapter-item expanded "><a href="penetration-test-report.html"><strong aria-hidden="true">4.5.</strong> Penetration Test Report</a></li><li class="chapter-item expanded "><a href="system-description.html"><strong aria-hidden="true">4.6.</strong> System Description (Section III)</a></li><li class="chapter-item expanded "><a href="tabletop-disaster-recovery-exercise.html"><strong aria-hidden="true">4.7.</strong> Tabletop Disaster Recovery Exercise</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MediZues Vanta Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Zues-Software-Inc/medizues-vanta-documentation.git" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="intrusion-detection-system-installation"><a class="header" href="#intrusion-detection-system-installation">Intrusion Detection System Installation</a></h1>
<div id="admonition-info" class="admonition admonish-info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="intrusion-detection-system-installation.html#admonition-info"></a></p>
</div>
<div>
<p>Solution:</p>
<ol>
<li>Deploy <code>snort</code> on all AWS EC2 instances</li>
<li>Collect <code>snort</code> logs, including <code>/var/log/snort/alert</code>, to CloudWatch</li>
</ol>
</div>
</div>
<h2 id="ansible-installation-fragment"><a class="header" href="#ansible-installation-fragment">Ansible Installation Fragment</a></h2>
<pre><code class="language-yml">- name: install
  block:
    - name: debconf snort
      ansible.builtin.debconf:
        name: snort
        question: snort/address_range
        vtyoe: string
        value: "{{ [ipv4.network, ipv4.netmask] | join('/') | ansible.utils.ipaddr('net') }}"
    - name: install snort
      ansible.builtin.package:
        name:
          - snort
        state: latest
      notify: [ 'restart snort' ]

- name: snort
  ansible.builtin.user:
    name: snort
  register: snort

- name: start snort
  service: name=snort enabled=yes state=started
</code></pre>
<p>Further, the Amazon CloudWatch Agent is configured to collect the
<code>/var/log/snort/alert</code> and <code>/var/log/snort/snort.log</code> files to AWS Log Groups
with the same name.  The <code>/var/log/snort/alert</code> log group is monitored for
alerts.</p>
<h2 id="test-with-screenshot"><a class="header" href="#test-with-screenshot">Test with Screenshot</a></h2>
<p>To test the configuration, network trafic capture files containing known
attacks were downloaded from
<a href="https://wiki.wireshark.org/SampleCaptures#Other_Sources_of_Capture_Files">https://wiki.wireshark.org/SampleCaptures#Other_Sources_of_Capture_Files</a> and
processed on a development EC2 instance with:</p>
<pre><code class="language-bash hidelines=!">$ ssh 10.143.0.4
Last login: Thu Feb  8 21:58:21 2024 from 10.4.0.4
ubuntu@ip-10-143-0-4:~$ sudo snort -vde -c /etc/snort/snort.conf -l /var/log/snort -r teardrop.cap -K ascii
Running in IDS mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
PortVar 'HTTP_PORTS' defined :  [ 80:81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000:7001 7144:7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180:8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090:9091 9443 9999 11371 34443:34444 41080 50002 55555 ]
PortVar 'SHELLCODE_PORTS' defined :  [ 0:79 81:65535 ]
PortVar 'ORACLE_PORTS' defined :  [ 1024:65535 ]
PortVar 'SSH_PORTS' defined :  [ 22 ]
PortVar 'FTP_PORTS' defined :  [ 21 2100 3535 ]
PortVar 'SIP_PORTS' defined :  [ 5060:5061 5600 ]
PortVar 'FILE_DATA_PORTS' defined :  [ 80:81 110 143 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000:7001 7144:7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180:8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090:9091 9443 9999 11371 34443:34444 41080 50002 55555 ]
PortVar 'GTP_PORTS' defined :  [ 2123 2152 3386 ]
<span class="boring">Detection:
</span><span class="boring">   Search-Method = AC-Full-Q
</span><span class="boring">    Split Any/Any group = enabled
</span><span class="boring">    Search-Method-Optimizations = enabled
</span><span class="boring">    Maximum pattern length = 20
</span><span class="boring">Tagged Packet Limit: 256
</span><span class="boring">Loading dynamic engine /usr/lib/snort_dynamicengine/libsf_engine.so... done
</span><span class="boring">Loading all dynamic detection libs from /usr/lib/snort_dynamicrules...
</span><span class="boring">WARNING: No dynamic libraries found in directory /usr/lib/snort_dynamicrules.
</span><span class="boring">  Finished Loading all dynamic detection libs from /usr/lib/snort_dynamicrules
</span><span class="boring">Loading all dynamic preprocessor libs from /usr/lib/snort_dynamicpreprocessor/...
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_ssh_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_reputation_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_smtp_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_modbus_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_sdf_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_dns_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_imap_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_sip_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_pop_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_dnp3_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_ftptelnet_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_gtp_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_dce2_preproc.so... done
</span><span class="boring">  Loading dynamic preprocessor library /usr/lib/snort_dynamicpreprocessor//libsf_ssl_preproc.so... done
</span><span class="boring">  Finished Loading all dynamic preprocessor libs from /usr/lib/snort_dynamicpreprocessor/
</span><span class="boring">Log directory = /var/log/snort
</span><span class="boring">WARNING: ip4 normalizations disabled because not inline.
</span><span class="boring">WARNING: tcp normalizations disabled because not inline.
</span><span class="boring">WARNING: icmp4 normalizations disabled because not inline.
</span><span class="boring">WARNING: ip6 normalizations disabled because not inline.
</span><span class="boring">WARNING: icmp6 normalizations disabled because not inline.
</span><span class="boring">Frag3 global config:
</span><span class="boring">    Max frags: 65536
</span><span class="boring">    Fragment memory cap: 4194304 bytes
</span><span class="boring">Frag3 engine config:
</span><span class="boring">    Bound Address: default
</span><span class="boring">    Target-based policy: WINDOWS
</span><span class="boring">    Fragment timeout: 180 seconds
</span><span class="boring">    Fragment min_ttl:   1
</span><span class="boring">    Fragment Anomalies: Alert
</span><span class="boring">    Overlap Limit:     10
</span><span class="boring">    Min fragment Length:     100
</span><span class="boring">      Max Expected Streams: 768
</span><span class="boring">Stream global config:
</span><span class="boring">    Track TCP sessions: ACTIVE
</span><span class="boring">    Max TCP sessions: 262144
</span><span class="boring">    TCP cache pruning timeout: 30 seconds
</span><span class="boring">    TCP cache nominal timeout: 3600 seconds
</span><span class="boring">    Memcap (for reassembly packet storage): 8388608
</span><span class="boring">    Track UDP sessions: ACTIVE
</span><span class="boring">    Max UDP sessions: 131072
</span><span class="boring">    UDP cache pruning timeout: 30 seconds
</span><span class="boring">    UDP cache nominal timeout: 180 seconds
</span><span class="boring">    Track ICMP sessions: INACTIVE
</span><span class="boring">    Track IP sessions: INACTIVE
</span><span class="boring">    Log info if session memory consumption exceeds 1048576
</span><span class="boring">    Send up to 2 active responses
</span><span class="boring">    Wait at least 5 seconds between responses
</span><span class="boring">    Protocol Aware Flushing: ACTIVE
</span><span class="boring">        Maximum Flush Point: 16000
</span><span class="boring">Stream TCP Policy config:
</span><span class="boring">    Bound Address: default
</span><span class="boring">    Reassembly Policy: WINDOWS
</span><span class="boring">    Timeout: 180 seconds
</span><span class="boring">    Limit on TCP Overlaps: 10
</span><span class="boring">    Maximum number of bytes to queue per session: 1048576
</span><span class="boring">    Maximum number of segs to queue per session: 2621
</span><span class="boring">    Options:
</span><span class="boring">        Require 3-Way Handshake: YES
</span><span class="boring">        3-Way Handshake Timeout: 180
</span><span class="boring">        Detect Anomalies: YES
</span><span class="boring">    Reassembly Ports:
</span><span class="boring">      21 client (Footprint)
</span><span class="boring">      22 client (Footprint)
</span><span class="boring">      23 client (Footprint)
</span><span class="boring">      25 client (Footprint)
</span><span class="boring">      42 client (Footprint)
</span><span class="boring">      53 client (Footprint)
</span><span class="boring">      79 client (Footprint)
</span><span class="boring">      80 client (Footprint) server (Footprint)
</span><span class="boring">      81 client (Footprint) server (Footprint)
</span><span class="boring">      109 client (Footprint)
</span><span class="boring">      110 client (Footprint)
</span><span class="boring">      111 client (Footprint)
</span><span class="boring">      113 client (Footprint)
</span><span class="boring">      119 client (Footprint)
</span><span class="boring">      135 client (Footprint)
</span><span class="boring">      136 client (Footprint)
</span><span class="boring">      137 client (Footprint)
</span><span class="boring">      139 client (Footprint)
</span><span class="boring">      143 client (Footprint)
</span><span class="boring">      161 client (Footprint)
</span><span class="boring">      additional ports configured but not printed.
</span><span class="boring">Stream UDP Policy config:
</span><span class="boring">    Timeout: 180 seconds
</span><span class="boring">HttpInspect Config:
</span><span class="boring">    GLOBAL CONFIG
</span><span class="boring">      Detect Proxy Usage:       NO
</span><span class="boring">      IIS Unicode Map Filename: /etc/snort/unicode.map
</span><span class="boring">      IIS Unicode Map Codepage: 1252
</span><span class="boring">      Memcap used for logging URI and Hostname: 150994944
</span><span class="boring">      Max Gzip Memory: 104857600
</span><span class="boring">      Max Gzip Sessions: 201649
</span><span class="boring">      Gzip Compress Depth: 65535
</span><span class="boring">      Gzip Decompress Depth: 65535
</span><span class="boring">    DEFAULT SERVER CONFIG:
</span><span class="boring">      Server profile: All
</span><span class="boring">      Ports (PAF): 80 81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000 7001 7144 7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180 8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090 9091 9443 9999 11371 34443 34444 41080 50002 55555
</span><span class="boring">      Server Flow Depth: 0
</span><span class="boring">      Client Flow Depth: 0
</span><span class="boring">      Max Chunk Length: 500000
</span><span class="boring">      Small Chunk Length Evasion: chunk size &lt;= 10, threshold &gt;= 5 times
</span><span class="boring">      Max Header Field Length: 750
</span><span class="boring">      Max Number Header Fields: 100
</span><span class="boring">      Max Number of WhiteSpaces allowed with header folding: 200
</span><span class="boring">      Inspect Pipeline Requests: YES
</span><span class="boring">      URI Discovery Strict Mode: NO
</span><span class="boring">      Allow Proxy Usage: NO
</span><span class="boring">      Disable Alerting: NO
</span><span class="boring">      Oversize Dir Length: 500
</span><span class="boring">      Only inspect URI: NO
</span><span class="boring">      Normalize HTTP Headers: NO
</span><span class="boring">      Inspect HTTP Cookies: YES
</span><span class="boring">      Inspect HTTP Responses: YES
</span><span class="boring">      Extract Gzip from responses: YES
</span><span class="boring">      Decompress response files:
</span><span class="boring">      Unlimited decompression of gzip data from responses: YES
</span><span class="boring">      Normalize Javascripts in HTTP Responses: YES
</span><span class="boring">      Max Number of WhiteSpaces allowed with Javascript Obfuscation in HTTP responses: 200
</span><span class="boring">      Normalize HTTP Cookies: NO
</span><span class="boring">      Enable XFF and True Client IP: NO
</span><span class="boring">      Log HTTP URI data: NO
</span><span class="boring">      Log HTTP Hostname data: NO
</span><span class="boring">      Extended ASCII code support in URI: NO
</span><span class="boring">      Ascii: YES alert: NO
</span><span class="boring">      Double Decoding: YES alert: NO
</span><span class="boring">      %U Encoding: YES alert: YES
</span><span class="boring">      Bare Byte: YES alert: NO
</span><span class="boring">      UTF 8: YES alert: NO
</span><span class="boring">      IIS Unicode: YES alert: NO
</span><span class="boring">      Multiple Slash: YES alert: NO
</span><span class="boring">      IIS Backslash: YES alert: NO
</span><span class="boring">      Directory Traversal: YES alert: NO
</span><span class="boring">      Web Root Traversal: YES alert: NO
</span><span class="boring">      Apache WhiteSpace: YES alert: NO
</span><span class="boring">      IIS Delimiter: YES alert: NO
</span><span class="boring">      IIS Unicode Map: GLOBAL IIS UNICODE MAP CONFIG
</span><span class="boring">      Non-RFC Compliant Characters: 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07
</span><span class="boring">      Whitespace Characters: 0x09 0x0b 0x0c 0x0d
</span><span class="boring">rpc_decode arguments:
</span><span class="boring">    Ports to decode RPC on: 111 32770 32771 32772 32773 32774 32775 32776 32777 32778 32779
</span><span class="boring">    alert_fragments: INACTIVE
</span><span class="boring">    alert_large_fragments: INACTIVE
</span><span class="boring">    alert_incomplete: INACTIVE
</span><span class="boring">    alert_multiple_requests: INACTIVE
</span><span class="boring">FTPTelnet Config:
</span><span class="boring">    GLOBAL CONFIG
</span><span class="boring">      Inspection Type: stateful
</span><span class="boring">      Check for Encrypted Traffic: YES alert: NO
</span><span class="boring">      Continue to check encrypted data: YES
</span><span class="boring">    TELNET CONFIG:
</span><span class="boring">      Ports: 23
</span><span class="boring">      Are You There Threshold: 20
</span><span class="boring">      Normalize: YES
</span><span class="boring">      Detect Anomalies: YES
</span><span class="boring">    FTP CONFIG:
</span><span class="boring">      FTP Server: default
</span><span class="boring">        Ports (PAF): 21 2100 3535
</span><span class="boring">        Check for Telnet Cmds: YES alert: YES
</span><span class="boring">        Ignore Telnet Cmd Operations: YES alert: YES
</span><span class="boring">        Ignore open data channels: NO
</span><span class="boring">      FTP Client: default
</span><span class="boring">        Check for Bounce Attacks: YES alert: YES
</span><span class="boring">        Check for Telnet Cmds: YES alert: YES
</span><span class="boring">        Ignore Telnet Cmd Operations: YES alert: YES
</span><span class="boring">        Max Response Length: 256
</span><span class="boring">SMTP Config:
</span><span class="boring">    Ports: 25 465 587 691
</span><span class="boring">    Inspection Type: Stateful
</span><span class="boring">    Normalize: ATRN AUTH BDAT DATA DEBUG EHLO EMAL ESAM ESND ESOM ETRN EVFY EXPN HELO HELP IDENT MAIL NOOP ONEX QUEU QUIT RCPT RSET SAML SEND STARTTLS SOML TICK TIME TURN TURNME VERB VRFY X-EXPS XADR XAUTH XCIR XEXCH50 XGEN XLICENSE X-LINK2STATE XQUE XSTA XTRN XUSR CHUNKING X-ADAT X-DRCP X-ERCP X-EXCH50
</span><span class="boring">    Ignore Data: No
</span><span class="boring">    Ignore TLS Data: No
</span><span class="boring">    Ignore SMTP Alerts: No
</span><span class="boring">    Max Command Line Length: 512
</span><span class="boring">    Max Specific Command Line Length:
</span><span class="boring">       ATRN:255 AUTH:246 BDAT:255 DATA:246 DEBUG:255
</span><span class="boring">       EHLO:500 EMAL:255 ESAM:255 ESND:255 ESOM:255
</span><span class="boring">       ETRN:246 EVFY:255 EXPN:255 HELO:500 HELP:500
</span><span class="boring">       IDENT:255 MAIL:260 NOOP:255 ONEX:246 QUEU:246
</span><span class="boring">       QUIT:246 RCPT:300 RSET:246 SAML:246 SEND:246
</span><span class="boring">       SIZE:255 STARTTLS:246 SOML:246 TICK:246 TIME:246
</span><span class="boring">       TURN:246 TURNME:246 VERB:246 VRFY:255 X-EXPS:246
</span><span class="boring">       XADR:246 XAUTH:246 XCIR:246 XEXCH50:246 XGEN:246
</span><span class="boring">       XLICENSE:246 X-LINK2STATE:246 XQUE:246 XSTA:246 XTRN:246
</span><span class="boring">       XUSR:246
</span><span class="boring">    Max Header Line Length: 1000
</span><span class="boring">    Max Response Line Length: 512
</span><span class="boring">    X-Link2State Alert: Yes
</span><span class="boring">    Drop on X-Link2State Alert: No
</span><span class="boring">    Alert on commands: None
</span><span class="boring">    Alert on unknown commands: No
</span><span class="boring">    SMTP Memcap: 838860
</span><span class="boring">    MIME Max Mem: 838860
</span><span class="boring">    Base64 Decoding: Enabled
</span><span class="boring">    Base64 Decoding Depth: Unlimited
</span><span class="boring">    Quoted-Printable Decoding: Enabled
</span><span class="boring">    Quoted-Printable Decoding Depth: Unlimited
</span><span class="boring">    Unix-to-Unix Decoding: Enabled
</span><span class="boring">    Unix-to-Unix Decoding Depth: Unlimited
</span><span class="boring">    Non-Encoded MIME attachment Extraction: Enabled
</span><span class="boring">    Non-Encoded MIME attachment Extraction Depth: Unlimited
</span><span class="boring">    Log Attachment filename: Enabled
</span><span class="boring">    Log MAIL FROM Address: Enabled
</span><span class="boring">    Log RCPT TO Addresses: Enabled
</span><span class="boring">    Log Email Headers: Enabled
</span><span class="boring">    Email Hdrs Log Depth: 1464
</span><span class="boring">SSH config:
</span><span class="boring">    Autodetection: ENABLED
</span><span class="boring">    Challenge-Response Overflow Alert: ENABLED
</span><span class="boring">    SSH1 CRC32 Alert: ENABLED
</span><span class="boring">    Server Version String Overflow Alert: ENABLED
</span><span class="boring">    Protocol Mismatch Alert: ENABLED
</span><span class="boring">    Bad Message Direction Alert: DISABLED
</span><span class="boring">    Bad Payload Size Alert: DISABLED
</span><span class="boring">    Unrecognized Version Alert: DISABLED
</span><span class="boring">    Max Encrypted Packets: 20
</span><span class="boring">    Max Server Version String Length: 100
</span><span class="boring">    MaxClientBytes: 19600 (Default)
</span><span class="boring">    Ports:
</span><span class="boring">	22
</span><span class="boring">DCE/RPC 2 Preprocessor Configuration
</span><span class="boring">  Global Configuration
</span><span class="boring">    DCE/RPC Defragmentation: Enabled
</span><span class="boring">    Memcap: 102400 KB
</span><span class="boring">    Events: co
</span><span class="boring">    SMB Fingerprint policy: Disabled
</span><span class="boring">  Server Default Configuration
</span><span class="boring">    Policy: WinXP
</span><span class="boring">    Detect ports (PAF)
</span><span class="boring">      SMB: 139 445
</span><span class="boring">      TCP: 135
</span><span class="boring">      UDP: 135
</span><span class="boring">      RPC over HTTP server: 593
</span><span class="boring">      RPC over HTTP proxy: None
</span><span class="boring">    Autodetect ports (PAF)
</span><span class="boring">      SMB: None
</span><span class="boring">      TCP: 1025-65535
</span><span class="boring">      UDP: 1025-65535
</span><span class="boring">      RPC over HTTP server: 1025-65535
</span><span class="boring">      RPC over HTTP proxy: None
</span><span class="boring">    Invalid SMB shares: C$ D$ ADMIN$
</span><span class="boring">    Maximum SMB command chaining: 3 commands
</span><span class="boring">    SMB file inspection: Disabled
</span><span class="boring">DNS config:
</span><span class="boring">    DNS Client rdata txt Overflow Alert: ACTIVE
</span><span class="boring">    Obsolete DNS RR Types Alert: INACTIVE
</span><span class="boring">    Experimental DNS RR Types Alert: INACTIVE
</span><span class="boring">    Ports: 53
</span><span class="boring">SSLPP config:
</span><span class="boring">    Encrypted packets: not inspected
</span><span class="boring">    Ports:
</span><span class="boring">      443      465      563      636      989
</span><span class="boring">      992      993      994      995     7801
</span><span class="boring">     7802     7900     7901     7902     7903
</span><span class="boring">     7904     7905     7906     7907     7908
</span><span class="boring">     7909     7910     7911     7912     7913
</span><span class="boring">     7914     7915     7916     7917     7918
</span><span class="boring">     7919     7920
</span><span class="boring">    Server side data is trusted
</span><span class="boring">    Maximum SSL Heartbeat length: 0
</span><span class="boring">Sensitive Data preprocessor config:
</span><span class="boring">    Global Alert Threshold: 25
</span><span class="boring">    Masked Output: DISABLED
</span><span class="boring">SIP config:
</span><span class="boring">    Max number of sessions: 40000
</span><span class="boring">    Max number of dialogs in a session: 4 (Default)
</span><span class="boring">    Status: ENABLED
</span><span class="boring">    Ignore media channel: DISABLED
</span><span class="boring">    Max URI length: 512
</span><span class="boring">    Max Call ID length: 80
</span><span class="boring">    Max Request name length: 20 (Default)
</span><span class="boring">    Max From length: 256 (Default)
</span><span class="boring">    Max To length: 256 (Default)
</span><span class="boring">    Max Via length: 1024 (Default)
</span><span class="boring">    Max Contact length: 512
</span><span class="boring">    Max Content length: 2048
</span><span class="boring">    Ports:
</span><span class="boring">	5060	5061	5600
</span><span class="boring">    Methods:
</span><span class="boring">	  invite cancel ack bye register options refer subscribe update join info message notify benotify do qauth sprack publish service unsubscribe prack
</span><span class="boring">IMAP Config:
</span><span class="boring">    Ports: 143
</span><span class="boring">    IMAP Memcap: 838860
</span><span class="boring">    MIME Max Mem: 838860
</span><span class="boring">    Base64 Decoding: Enabled
</span><span class="boring">    Base64 Decoding Depth: Unlimited
</span><span class="boring">    Quoted-Printable Decoding: Enabled
</span><span class="boring">    Quoted-Printable Decoding Depth: Unlimited
</span><span class="boring">    Unix-to-Unix Decoding: Enabled
</span><span class="boring">    Unix-to-Unix Decoding Depth: Unlimited
</span><span class="boring">    Non-Encoded MIME attachment Extraction: Enabled
</span><span class="boring">    Non-Encoded MIME attachment Extraction Depth: Unlimited
</span><span class="boring">POP Config:
</span><span class="boring">    Ports: 110
</span><span class="boring">    POP Memcap: 838860
</span><span class="boring">    MIME Max Mem: 838860
</span><span class="boring">    Base64 Decoding: Enabled
</span><span class="boring">    Base64 Decoding Depth: Unlimited
</span><span class="boring">    Quoted-Printable Decoding: Enabled
</span><span class="boring">    Quoted-Printable Decoding Depth: Unlimited
</span><span class="boring">    Unix-to-Unix Decoding: Enabled
</span><span class="boring">    Unix-to-Unix Decoding Depth: Unlimited
</span><span class="boring">    Non-Encoded MIME attachment Extraction: Enabled
</span><span class="boring">    Non-Encoded MIME attachment Extraction Depth: Unlimited
</span><span class="boring">Modbus config:
</span><span class="boring">    Ports:
</span><span class="boring">	502
</span><span class="boring">DNP3 config:
</span><span class="boring">    Memcap: 262144
</span><span class="boring">    Check Link-Layer CRCs: ENABLED
</span><span class="boring">    Ports:
</span><span class="boring">	20000
</span><span class="boring">
</span><span class="boring">+++++++++++++++++++++++++++++++++++++++++++++++++++
</span><span class="boring">Initializing rule chains...
</span><span class="boring">WARNING: /etc/snort/rules/chat.rules(33) threshold (in rule) is deprecated; use detection_filter instead.
</span><span class="boring">
</span><span class="boring">WARNING: /etc/snort/rules/community-sql-injection.rules(6) GID 1 SID 100000106 in rule duplicates previous rule. Ignoring old rule.
</span><span class="boring">
</span><span class="boring">...
</span><span class="boring">
</span><span class="boring">WARNING: /etc/snort/rules/community-web-php.rules(474) GID 1 SID 100000934 in rule duplicates previous rule. Ignoring old rule.
</span><span class="boring">
</span><span class="boring">4150 Snort rules read
</span><span class="boring">    3476 detection rules
</span><span class="boring">    0 decoder rules
</span><span class="boring">    0 preprocessor rules
</span><span class="boring">3476 Option Chains linked into 271 Chain Headers
</span><span class="boring">0 Dynamic rules
</span><span class="boring">+++++++++++++++++++++++++++++++++++++++++++++++++++
</span><span class="boring">
</span><span class="boring">+-------------------[Rule Port Counts]---------------------------------------
</span><span class="boring">|             tcp     udp    icmp      ip
</span><span class="boring">|     src     151      18       0       0
</span><span class="boring">|     dst    3306     126       0       0
</span><span class="boring">|     any     383      48     145      22
</span><span class="boring">|      nc      27       8      94      20
</span><span class="boring">|     s+d      12       5       0       0
</span><span class="boring">+----------------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">+-----------------------[detection-filter-config]------------------------------
</span><span class="boring">| memory-cap : 1048576 bytes
</span><span class="boring">+-----------------------[detection-filter-rules]-------------------------------
</span><span class="boring">| none
</span><span class="boring">-------------------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">+-----------------------[rate-filter-config]-----------------------------------
</span><span class="boring">| memory-cap : 1048576 bytes
</span><span class="boring">+-----------------------[rate-filter-rules]------------------------------------
</span><span class="boring">| none
</span><span class="boring">-------------------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">+-----------------------[event-filter-config]----------------------------------
</span><span class="boring">| memory-cap : 1048576 bytes
</span><span class="boring">+-----------------------[event-filter-global]----------------------------------
</span><span class="boring">| none
</span><span class="boring">+-----------------------[event-filter-local]-----------------------------------
</span><span class="boring">| gen-id=1      sig-id=2923       type=Threshold tracking=dst count=10  seconds=60
</span><span class="boring">| gen-id=1      sig-id=2494       type=Both      tracking=dst count=20  seconds=60
</span><span class="boring">| gen-id=1      sig-id=3273       type=Threshold tracking=src count=5   seconds=2
</span><span class="boring">| gen-id=1      sig-id=2496       type=Both      tracking=dst count=20  seconds=60
</span><span class="boring">| gen-id=1      sig-id=2495       type=Both      tracking=dst count=20  seconds=60
</span><span class="boring">| gen-id=1      sig-id=2924       type=Threshold tracking=dst count=10  seconds=60
</span><span class="boring">| gen-id=1      sig-id=2275       type=Threshold tracking=dst count=5   seconds=60
</span><span class="boring">| gen-id=1      sig-id=2523       type=Both      tracking=dst count=10  seconds=10
</span><span class="boring">| gen-id=1      sig-id=1991       type=Limit     tracking=src count=1   seconds=60
</span><span class="boring">| gen-id=1      sig-id=3152       type=Threshold tracking=src count=5   seconds=2
</span><span class="boring">+-----------------------[suppression]------------------------------------------
</span><span class="boring">| none
</span><span class="boring">-------------------------------------------------------------------------------
</span><span class="boring">Rule application order: activation-&gt;dynamic-&gt;pass-&gt;drop-&gt;sdrop-&gt;reject-&gt;alert-&gt;log
</span><span class="boring">Verifying Preprocessor Configurations!
</span><span class="boring">WARNING: flowbits key 'ms_sql_seen_dns' is checked but not ever set.
</span><span class="boring">WARNING: flowbits key 'smb.tree.create.llsrpc' is set but not ever checked.
</span><span class="boring">33 out of 1024 flowbits in use.
</span><span class="boring">
</span><span class="boring">[ Port Based Pattern Matching Memory ]
</span><span class="boring">+- [ Aho-Corasick Summary ] -------------------------------------
</span><span class="boring">| Storage Format    : Full-Q
</span><span class="boring">| Finite Automaton  : DFA
</span><span class="boring">| Alphabet Size     : 256 Chars
</span><span class="boring">| Sizeof State      : Variable (1,2,4 bytes)
</span><span class="boring">| Instances         : 215
</span><span class="boring">|     1 byte states : 204
</span><span class="boring">|     2 byte states : 11
</span><span class="boring">|     4 byte states : 0
</span><span class="boring">| Characters        : 64982
</span><span class="boring">| States            : 32135
</span><span class="boring">| Transitions       : 872051
</span><span class="boring">| State Density     : 10.6%
</span><span class="boring">| Patterns          : 5055
</span><span class="boring">| Match States      : 3855
</span><span class="boring">| Memory (MB)       : 17.00
</span><span class="boring">|   Patterns        : 0.51
</span><span class="boring">|   Match Lists     : 1.02
</span><span class="boring">|   DFA
</span><span class="boring">|     1 byte states : 1.02
</span><span class="boring">|     2 byte states : 14.05
</span><span class="boring">|     4 byte states : 0.00
</span><span class="boring">+----------------------------------------------------------------
</span><span class="boring">[ Number of patterns truncated to 20 bytes: 1039 ]
</span><span class="boring">pcap DAQ configured to read-file.
</span><span class="boring">Acquiring network traffic from "teardrop.cap".
</span><span class="boring">Reload thread starting...
</span><span class="boring">Reload thread started, thread 0x7fefe689d700 (52422)
</span><span class="boring">WARNING: active responses disabled since DAQ can't inject packets.
</span><span class="boring">
</span><span class="boring">        --== Initialization Complete ==--
</span><span class="boring">
</span><span class="boring">   ,,_     -*&gt; Snort! &lt;*-
</span><span class="boring">  o"  )~   Version 2.9.7.0 GRE (Build 149)
</span><span class="boring">   ''''    By Martin Roesch &amp; The Snort Team: http://www.snort.org/contact#team
</span><span class="boring">           Copyright (C) 2014 Cisco and/or its affiliates. All rights reserved.
</span><span class="boring">           Copyright (C) 1998-2013 Sourcefire, Inc., et al.
</span><span class="boring">           Using libpcap version 1.9.1 (with TPACKET_V3)
</span><span class="boring">           Using PCRE version: 8.39 2016-06-14
</span><span class="boring">           Using ZLIB version: 1.2.11
</span><span class="boring">
</span><span class="boring">           Rules Engine: SF_SNORT_DETECTION_ENGINE  Version 2.4  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_SSLPP  Version 1.1  &lt;Build 4&gt;
</span><span class="boring">           Preprocessor Object: SF_DCERPC2  Version 1.0  &lt;Build 3&gt;
</span><span class="boring">           Preprocessor Object: SF_GTP  Version 1.1  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_FTPTELNET  Version 1.2  &lt;Build 13&gt;
</span><span class="boring">           Preprocessor Object: SF_DNP3  Version 1.1  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_POP  Version 1.0  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_SIP  Version 1.1  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_IMAP  Version 1.0  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_DNS  Version 1.1  &lt;Build 4&gt;
</span><span class="boring">           Preprocessor Object: SF_SDF  Version 1.1  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_MODBUS  Version 1.1  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_SMTP  Version 1.1  &lt;Build 9&gt;
</span><span class="boring">           Preprocessor Object: SF_REPUTATION  Version 1.1  &lt;Build 1&gt;
</span><span class="boring">           Preprocessor Object: SF_SSH  Version 1.1  &lt;Build 3&gt;
</span><span class="boring">Commencing packet processing (pid=52414)
</span><span class="boring">09/09-04:11:26.294020 00:40:33:D9:7C:FD -&gt; 00:00:39:CF:D9:CD type:0x800 len:0x4E
</span><span class="boring">10.0.0.6:1035 -&gt; 151.164.1.8:53 UDP TTL:64 TOS:0x0 ID:5092 IpLen:20 DgmLen:64
</span><span class="boring">Len: 36
</span><span class="boring">7D 9E 01 00 00 01 00 00 00 00 00 00 06 70 69 63  }............pic
</span><span class="boring">61 72 64 07 75 74 68 73 63 73 61 03 65 64 75 00  ard.uthscsa.edu.
</span><span class="boring">00 01 00 01                                      ....
</span><span class="boring">
</span><span class="boring">=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</span><span class="boring">
</span><span class="boring">09/09-04:11:26.613908 00:00:39:CF:D9:CD -&gt; 00:40:33:D9:7C:FD type:0x800 len:0x121
</span><span class="boring">151.164.1.8:53 -&gt; 10.0.0.6:1035 UDP TTL:246 TOS:0x0 ID:40029 IpLen:20 DgmLen:275 DF
</span><span class="boring">Len: 247
</span><span class="boring">7D 9E 85 80 00 01 00 01 00 05 00 05 06 70 69 63  }............pic
</span><span class="boring">61 72 64 07 75 74 68 73 63 73 61 03 65 64 75 00  ard.uthscsa.edu.
</span><span class="boring">00 01 00 01 C0 0C 00 01 00 01 00 00 0E 10 00 04  ................
</span><span class="boring">81 6F 1E 1B 07 75 74 68 73 63 73 61 03 65 64 75  .o...uthscsa.edu
</span><span class="boring">00 00 02 00 01 00 00 0E 10 00 09 06 6B 65 6E 6F  ............keno
</span><span class="boring">62 69 C0 34 C0 34 00 02 00 01 00 00 0E 10 00 07  bi.4.4..........
</span><span class="boring">04 6A 69 6E 6E C0 34 C0 34 00 02 00 01 00 00 0E  .jinn.4.4.......
</span><span class="boring">10 00 0C 04 64 6E 73 31 04 6E 6A 69 74 C0 3C C0  ....dns1.njit.&lt;.
</span><span class="boring">34 00 02 00 01 00 00 0E 10 00 08 05 65 6C 7A 69  4...........elzi
</span><span class="boring">70 C0 34 C0 34 00 02 00 01 00 00 0E 10 00 08 05  p.4.4...........
</span><span class="boring">61 72 77 65 6E C0 34 C0 4B 00 01 00 01 00 00 0E  arwen.4.K.......
</span><span class="boring">10 00 04 81 6F 1A 06 C0 60 00 01 00 01 00 00 0E  ....o...`.......
</span><span class="boring">10 00 04 81 6F 1A 07 C0 73 00 01 00 01 00 01 03  ....o...s.......
</span><span class="boring">82 00 04 80 EB FB 0A C0 8B 00 01 00 01 00 00 0E  ................
</span><span class="boring">10 00 04 81 6F 01 0B C0 9F 00 01 00 01 00 00 0E  ....o...........
</span><span class="boring">10 00 04 81 6F 0B 51                             ....o.Q
</span><span class="boring">
</span><span class="boring">=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</span><span class="boring">
</span><span class="boring">09/09-04:11:26.616445 00:40:33:D9:7C:FD -&gt; 00:00:39:CF:D9:CD type:0x800 len:0x26
</span><span class="boring">10.1.1.1 -&gt; 129.111.30.27 UDP TTL:64 TOS:0x0 ID:242 IpLen:20 DgmLen:24
</span><span class="boring">Frag Offset: 0x0003   Frag Size: 0x0004
</span><span class="boring">7C AB 4E E5                                      |.N.
</span><span class="boring">
</span><span class="boring">=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</span><span class="boring">
</span><span class="boring">===============================================================================
</span><span class="boring">Run time for packet processing was 1.389 seconds
</span><span class="boring">Snort processed 17 packets.
</span><span class="boring">Snort ran for 0 days 0 hours 0 minutes 1 seconds
</span><span class="boring">   Pkts/sec:           17
</span><span class="boring">===============================================================================
</span><span class="boring">Memory usage summary:
</span><span class="boring">  Total non-mmapped bytes (arena):       46100480
</span><span class="boring">  Bytes in mapped regions (hblkhd):      13746176
</span><span class="boring">  Total allocated space (uordblks):      40492080
</span><span class="boring">  Total free space (fordblks):           5608400
</span><span class="boring">  Topmost releasable block (keepcost):   26784
</span><span class="boring">===============================================================================
</span><span class="boring">Packet I/O Totals:
</span><span class="boring">   Received:           17
</span><span class="boring">   Analyzed:           17 (100.000%)
</span><span class="boring">    Dropped:            0 (  0.000%)
</span><span class="boring">   Filtered:            0 (  0.000%)
</span><span class="boring">Outstanding:            0 (  0.000%)
</span><span class="boring">   Injected:            0
</span><span class="boring">===============================================================================
</span><span class="boring">Breakdown by protocol (includes rebuilt packets):
</span><span class="boring">        Eth:           17 (100.000%)
</span><span class="boring">       VLAN:            0 (  0.000%)
</span><span class="boring">        IP4:            6 ( 35.294%)
</span><span class="boring">       Frag:            2 ( 11.765%)
</span><span class="boring">       ICMP:            2 ( 11.765%)
</span><span class="boring">        UDP:            3 ( 17.647%)
</span><span class="boring">        TCP:            0 (  0.000%)
</span><span class="boring">        IP6:            0 (  0.000%)
</span><span class="boring">    IP6 Ext:            0 (  0.000%)
</span><span class="boring">   IP6 Opts:            0 (  0.000%)
</span><span class="boring">      Frag6:            0 (  0.000%)
</span><span class="boring">      ICMP6:            0 (  0.000%)
</span><span class="boring">       UDP6:            0 (  0.000%)
</span><span class="boring">       TCP6:            0 (  0.000%)
</span><span class="boring">     Teredo:            0 (  0.000%)
</span><span class="boring">    ICMP-IP:            0 (  0.000%)
</span><span class="boring">    IP4/IP4:            0 (  0.000%)
</span><span class="boring">    IP4/IP6:            0 (  0.000%)
</span><span class="boring">    IP6/IP4:            0 (  0.000%)
</span><span class="boring">    IP6/IP6:            0 (  0.000%)
</span><span class="boring">        GRE:            0 (  0.000%)
</span><span class="boring">    GRE Eth:            0 (  0.000%)
</span><span class="boring">   GRE VLAN:            0 (  0.000%)
</span><span class="boring">    GRE IP4:            0 (  0.000%)
</span><span class="boring">    GRE IP6:            0 (  0.000%)
</span><span class="boring">GRE IP6 Ext:            0 (  0.000%)
</span><span class="boring">   GRE PPTP:            0 (  0.000%)
</span><span class="boring">    GRE ARP:            0 (  0.000%)
</span><span class="boring">    GRE IPX:            0 (  0.000%)
</span><span class="boring">   GRE Loop:            0 (  0.000%)
</span><span class="boring">       MPLS:            0 (  0.000%)
</span><span class="boring">        ARP:            5 ( 29.412%)
</span><span class="boring">        IPX:            0 (  0.000%)
</span><span class="boring">   Eth Loop:            5 ( 29.412%)
</span><span class="boring">   Eth Disc:            0 (  0.000%)
</span><span class="boring">   IP4 Disc:            0 (  0.000%)
</span><span class="boring">   IP6 Disc:            0 (  0.000%)
</span><span class="boring">   TCP Disc:            0 (  0.000%)
</span><span class="boring">   UDP Disc:            0 (  0.000%)
</span><span class="boring">  ICMP Disc:            0 (  0.000%)
</span><span class="boring">All Discard:            0 (  0.000%)
</span><span class="boring">      Other:            1 (  5.882%)
</span><span class="boring">Bad Chk Sum:            0 (  0.000%)
</span><span class="boring">    Bad TTL:            0 (  0.000%)
</span><span class="boring">     S5 G 1:            0 (  0.000%)
</span><span class="boring">     S5 G 2:            0 (  0.000%)
</span><span class="boring">      Total:           17
</span><span class="boring">===============================================================================
</span><span class="boring">Action Stats:
</span><span class="boring">     Alerts:            5 ( 29.412%)
</span><span class="boring">     Logged:            5 ( 29.412%)
</span><span class="boring">     Passed:            0 (  0.000%)
</span><span class="boring">Limits:
</span><span class="boring">      Match:            0
</span><span class="boring">      Queue:            0
</span><span class="boring">        Log:            0
</span><span class="boring">      Event:            0
</span><span class="boring">      Alert:            0
</span><span class="boring">Verdicts:
</span><span class="boring">      Allow:           17 (100.000%)
</span><span class="boring">      Block:            0 (  0.000%)
</span><span class="boring">    Replace:            0 (  0.000%)
</span><span class="boring">  Whitelist:            0 (  0.000%)
</span><span class="boring">  Blacklist:            0 (  0.000%)
</span><span class="boring">     Ignore:            0 (  0.000%)
</span><span class="boring">      Retry:            0 (  0.000%)
</span><span class="boring">===============================================================================
</span><span class="boring">Frag3 statistics:
</span><span class="boring">        Total Fragments: 2
</span><span class="boring">      Frags Reassembled: 0
</span><span class="boring">               Discards: 1
</span><span class="boring">          Memory Faults: 0
</span><span class="boring">               Timeouts: 0
</span><span class="boring">               Overlaps: 1
</span><span class="boring">              Anomalies: 2
</span><span class="boring">                 Alerts: 2
</span><span class="boring">                  Drops: 0
</span><span class="boring">     FragTrackers Added: 1
</span><span class="boring">    FragTrackers Dumped: 1
</span><span class="boring">FragTrackers Auto Freed: 0
</span><span class="boring">    Frag Nodes Inserted: 1
</span><span class="boring">     Frag Nodes Deleted: 1
</span><span class="boring">===============================================================================
</span><span class="boring">===============================================================================
</span><span class="boring">Stream statistics:
</span><span class="boring">            Total sessions: 1
</span><span class="boring">              TCP sessions: 0
</span><span class="boring">              UDP sessions: 1
</span><span class="boring">             ICMP sessions: 0
</span><span class="boring">               IP sessions: 0
</span><span class="boring">                TCP Prunes: 0
</span><span class="boring">                UDP Prunes: 0
</span><span class="boring">               ICMP Prunes: 0
</span><span class="boring">                 IP Prunes: 0
</span><span class="boring">TCP StreamTrackers Created: 0
</span><span class="boring">TCP StreamTrackers Deleted: 0
</span><span class="boring">              TCP Timeouts: 0
</span><span class="boring">              TCP Overlaps: 0
</span><span class="boring">       TCP Segments Queued: 0
</span><span class="boring">     TCP Segments Released: 0
</span><span class="boring">       TCP Rebuilt Packets: 0
</span><span class="boring">         TCP Segments Used: 0
</span><span class="boring">              TCP Discards: 0
</span><span class="boring">                  TCP Gaps: 0
</span><span class="boring">      UDP Sessions Created: 1
</span><span class="boring">      UDP Sessions Deleted: 1
</span><span class="boring">              UDP Timeouts: 0
</span><span class="boring">              UDP Discards: 0
</span><span class="boring">                    Events: 0
</span><span class="boring">           Internal Events: 0
</span><span class="boring">           TCP Port Filter
</span><span class="boring">                  Filtered: 0
</span><span class="boring">                 Inspected: 0
</span><span class="boring">                   Tracked: 0
</span><span class="boring">           UDP Port Filter
</span><span class="boring">                  Filtered: 0
</span><span class="boring">                 Inspected: 0
</span><span class="boring">                   Tracked: 1
</span><span class="boring">===============================================================================
</span><span class="boring">===============================================================================
</span><span class="boring">SMTP Preprocessor Statistics
</span><span class="boring">  Total sessions                                    : 0
</span><span class="boring">  Max concurrent sessions                           : 0
</span><span class="boring">===============================================================================
</span><span class="boring">dcerpc2 Preprocessor Statistics
</span><span class="boring">  Total sessions: 0
</span><span class="boring">===============================================================================
</span><span class="boring">===============================================================================
</span><span class="boring">SIP Preprocessor Statistics
</span><span class="boring">  Total sessions: 0
</span><span class="boring">===============================================================================
</span>...
Snort exiting
</code></pre>
<pre><code class="language-bash">ubuntu@ip-10-143-0-4:~$ cat /var/log/snort/alert
[**] [1:270:6] DOS Teardrop attack [**]
[Classification: Attempted Denial of Service] [Priority: 2]
09/09-04:11:26.616090 00:40:33:D9:7C:FD -&gt; 00:00:39:CF:D9:CD type:0x800 len:0x46
10.1.1.1 -&gt; 129.111.30.27 UDP TTL:64 TOS:0x0 ID:242 IpLen:20 DgmLen:56 MF
Frag Offset: 0x0000   Frag Size: 0x0024
[Xref =&gt; http://www.cert.org/advisories/CA-1997-28.html][Xref =&gt; http://cgi.nessus.org/plugins/dump.php3?id=10279][Xref =&gt; http://cve.mitre.org/cgi-bin/cvename.cgi?name=1999-0015][Xref =&gt; http://www.securityfocus.com/bid/124]

[**] [1:368:6] ICMP PING BSDtype [**]
[Classification: Misc activity] [Priority: 3]
09/09-04:11:43.974523 00:40:33:D9:7C:FD -&gt; 00:00:39:CF:D9:CD type:0x800 len:0x62
10.0.0.6 -&gt; 10.0.0.254 ICMP TTL:64 TOS:0x0 ID:5093 IpLen:20 DgmLen:84
Type:8  Code:0  ID:50203   Seq:0  ECHO
[Xref =&gt; http://www.whitehats.com/info/IDS152]

[**] [1:366:7] ICMP PING *NIX [**]
[Classification: Misc activity] [Priority: 3]
09/09-04:11:43.974523 00:40:33:D9:7C:FD -&gt; 00:00:39:CF:D9:CD type:0x800 len:0x62
10.0.0.6 -&gt; 10.0.0.254 ICMP TTL:64 TOS:0x0 ID:5093 IpLen:20 DgmLen:84
Type:8  Code:0  ID:50203   Seq:0  ECHO

[**] [1:384:5] ICMP PING [**]
[Classification: Misc activity] [Priority: 3]
09/09-04:11:43.974523 00:40:33:D9:7C:FD -&gt; 00:00:39:CF:D9:CD type:0x800 len:0x62
10.0.0.6 -&gt; 10.0.0.254 ICMP TTL:64 TOS:0x0 ID:5093 IpLen:20 DgmLen:84
Type:8  Code:0  ID:50203   Seq:0  ECHO

[**] [1:408:5] ICMP Echo Reply [**]
[Classification: Misc activity] [Priority: 3]
09/09-04:11:43.978794 00:00:39:CF:D9:CD -&gt; 00:40:33:D9:7C:FD type:0x800 len:0x62
10.0.0.254 -&gt; 10.0.0.6 ICMP TTL:255 TOS:0x0 ID:10 IpLen:20 DgmLen:84
Type:0  Code:0  ID:50203  Seq:0  ECHO REPLY
</code></pre>
<p>The configuration detected the attack and logged the alert to CloudWatch:</p>
<p><img src="intrusion-detection-system-installation/cloudwatch.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="network-diagram"><a class="header" href="#network-diagram">Network Diagram</a></h1>
<div id="admonition-info" class="admonition admonish-info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="network-diagram.html#admonition-info"></a></p>
</div>
<div>
<p>Development and staging are segregated from production by being separate VPCs.</p>
<p>Production MongoDB services are provided by MongoDB Atlas.</p>
<p>The MediZues configuration will be scaled as required by customer traffic and
this diagram will be updated accordingly.</p>
</div>
</div>
<p><img src="network-diagram.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="network-segregation"><a class="header" href="#network-segregation">Network Segregation</a></h1>
<div id="admonition-info" class="admonition admonish-info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="network-segregation.html#admonition-info"></a></p>
</div>
<div>
<p>Development and staging are segregated from production by being separate VPCs.</p>
<p>"Public" and "private" subnets are configured in each availability zone for
planned scaling of the solution.</p>
</div>
</div>
<p><img src="network-diagram.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="application-access-request-denied-log"><a class="header" href="#application-access-request-denied-log">Application Access Request Denied Log</a></h1>
<div id="admonition-info" class="admonition admonish-info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="application-access-request-denied-log.html#admonition-info"></a></p>
</div>
<div>
<p>This document provides the screenshots of the corresponding log entries from a
known denied login attempt.</p>
</div>
</div>
<p>Medizues Login Screen (with invalid username and password):</p>
<p><img src="application-access-request-denied-log/screenshot-1.png" alt="" /></p>
<p>Errors for the event are recorded in the <code>nginx/access.log</code> CloudWatch logs:</p>
<p><img src="application-access-request-denied-log/screenshot-2.png" alt="" /></p>
<p>And further detail for the same events are included in the <code>pm2</code> logs:</p>
<p><img src="application-access-request-denied-log/screenshot-3.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="incident-report-or-root-cause-analysis"><a class="header" href="#incident-report-or-root-cause-analysis">Incident report or root cause analysis</a></h1>
<p><a href="https://app.vanta.com/documents/incident-report-example">https://app.vanta.com/documents/incident-report-example</a></p>
<p><a href="https://docs.google.com/document/d/1GQ65anb27htT60FDE3H93ee-DBPXxtgtGLoEcn_SpQg/edit?usp=drive_link">https://docs.google.com/document/d/1GQ65anb27htT60FDE3H93ee-DBPXxtgtGLoEcn_SpQg/edit?usp=drive_link</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="test-of-incident-response-plan"><a class="header" href="#test-of-incident-response-plan">Test of incident response plan</a></h1>
<p><a href="https://app.vanta.com/documents/incident-response-plan-test">https://app.vanta.com/documents/incident-response-plan-test</a></p>
<p><a href="https://docs.google.com/document/d/1B3kvCemQIFNEmhe62lVWBMdyNS1RnUcz2QlACZrqjbw/edit?usp=drive_link">https://docs.google.com/document/d/1B3kvCemQIFNEmhe62lVWBMdyNS1RnUcz2QlACZrqjbw/edit?usp=drive_link</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="proof-of-completed-access-review"><a class="header" href="#proof-of-completed-access-review">Proof of completed access review</a></h1>
<p><a href="https://app.vanta.com/documents/access-reviews">https://app.vanta.com/documents/access-reviews</a></p>
<div class="table-wrapper"><table><thead><tr><th>Document</th><th>URL</th></tr></thead><tbody>
<tr><td>Vanta Template</td><td><a href="https://docs.google.com/document/d/1DjWe3WgW1H6Q3jiNmPptUfUo3H_McvJ-YEO_NzRyk9s/copy?usp=sharing">https://docs.google.com/document/d/1DjWe3WgW1H6Q3jiNmPptUfUo3H_McvJ-YEO_NzRyk9s/copy?usp=sharing</a></td></tr>
<tr><td>2024Q1</td><td><a href="https://docs.google.com/document/d/1JyOAgPUiWrxNES1ZWAYfq5iy9PBLiavmoBxrVG2rFTE/edit?usp=sharing">https://docs.google.com/document/d/1JyOAgPUiWrxNES1ZWAYfq5iy9PBLiavmoBxrVG2rFTE/edit?usp=sharing</a></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="application-session-timeout"><a class="header" href="#application-session-timeout">Application Session Timeout</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-restore-test"><a class="header" href="#data-restore-test">Data Restore Test</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="enabled-automated-log-alerting"><a class="header" href="#enabled-automated-log-alerting">Enabled Automated Log Alerting</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="penetration-test-remediation"><a class="header" href="#penetration-test-remediation">Penetration Test Remediation</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="penetration-test-report"><a class="header" href="#penetration-test-report">Penetration Test Report</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-description-section-iii"><a class="header" href="#system-description-section-iii">System Description (Section III)</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tabletop-disaster-recovery-exercise"><a class="header" href="#tabletop-disaster-recovery-exercise">Tabletop Disaster Recovery Exercise</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="mermaid.min.js"></script>
        <script src="mermaid-init.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
